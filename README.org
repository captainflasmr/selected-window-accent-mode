#+title: selected-window-accent-mode
#+author: James Dyer
#+email: captainflasmr@gmail.com
#+language: en
#+options: ':t toc:nil author:nil email:nil num:nil title:nil
#+todo: WATCH TODO DOING | DONE
#+startup: showall

* Summary

The Selected Window Accent Mode is an Emacs package designed to visually distinguish the currently selected window by applying a unique accent color to its fringes, mode line, header line, and margins.

** Whats New

*** v0.6.0+

**** DONE ISSUE #3 Package breaks fringes
CLOSED: [2024-05-16 Thu 17:02]
**** DONE restore modeline height when switching between modes

*** v0.6.0 <2024-02-09 Fri>

**** DONE ISSUE #1 Do not apply highlighting when frame only contains 1 window
CLOSED: [2024-02-08 Thu 16:00]
**** DONE define accent color saturation adjustment
CLOSED: [2024-02-08 Thu 12:13]
**** DONE define accent color darken adjustment
CLOSED: [2024-02-08 Thu 12:13]
**** DONE highlight selected tab with same accent color
CLOSED: [2024-02-08 Thu 11:17]
**** DONE add to MELPA
CLOSED: [2024-02-04 Sun 11:17]

** Screenshot

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/selected-window-accent-mode-00.jpg]]

** Quick Start

To use left and bottom accent based on the themes highlight colour:

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 10)
  (selected-window-accent-custom-color nil)
  (selected-window-accent-mode-style 'subtle))
#+end_src

OR define your own colour:

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 10)
  (selected-window-accent-custom-color "#427900")
  (selected-window-accent-mode-style 'subtle))
#+end_src

** Alternative window highlighting packages

There exist a few Emacs packages that perform window highlighting but that don't quite provide the feature set of selected-window-accent.

selected-window-accent focusses more on clearly but non-intrusively highlighting the currently selected/focussed window by highlighting aspects of the window border without having to modify the appearance of non-selected windows, hence more akin to a tiling window manager.

*** dimmer

"This package provides a minor mode that indicates which buffer is currently active by dimming the faces in the other buffers."

This is the closest in functionality to selected-window-accent, the difference being that dimmer dims non selected windows rather than accent the selected window.

dimmer can be used in conjunction and will complement selected-window-accent to further enhance the emphasizing of the selected window.

*** hiwin

"This package provides a minor-mode to change the background colour of the non active window."

It uses overlays to highlight non active windows, so is similar to dimmer but is less subtle in its highlighting mechanism and hasn't been updated in excess of 10 years.

*** color-theme-buffer-local

"This package lets you set a color-theme on a per-buffer basis."

Unlike dimmer and hiwin this package isn't related to the concept of a selected window but more of defining different themes for different windows to distinguish them.

*** solaire-mode

"This package is designed to visually distinguish "real" buffers (i.e. file-visiting code buffers where you do most of your work) from "unreal" buffers (like popups, sidebars, log buffers, terminals, etc) by giving the latter a slightly different -- often darker -- background"

Unlike dimmer and hiwin this package isn't related to the concept of a selected window but more of distinguishing between collections of IDE like elements within Emacs.

* Installation

** use-package (MELPA)

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1))
#+end_src

** use-package (emacs 29)

Put the following into your emacs init file:

#+begin_src elisp
(use-package selected-window-accent-mode
  :vc (:fetcher github :repo "captainflasmr/selected-window-accent-mode")
  :config (selected-window-accent-mode 1))
#+end_src

** from source

Download the `.el` file and place it in your Emacs `load-path`.

Then either manually load it or add it to your configuration to be loaded at startup.

#+begin_src elisp
(require 'selected-window-accent-mode)
(selected-window-accent-mode 1)
#+end_src

* Usage

Interactively Toggle the mode on and off =M-x selected-window-accent-mode=

Interactively change the current style =M-x selected-window-accent--switch-selected-window-accent-style= which will present a =completing-read= selection in the minibuffer

The styles that are currently supported :

- default
- tiling
- subtle

see *roadmap* below for a description.

Typically I have bound these two interactive functions to a new keymap where I keep all my emacs visual change functions.

#+begin_src elisp
(defvar my-win-keymap (make-sparse-keymap))
(global-set-key (kbd "M-o") my-win-keymap)
(define-key my-win-keymap (kbd "a") 'selected-window-accent-mode)
(define-key my-win-keymap (kbd "y") 'selected-window-accent--switch-selected-window-accent-style)
#+end_src

* Examples

** Example 1 - Default / custom color

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/selected-window-accent-mode-01.jpg]]

To enable the accent mode automatically upon starting Emacs, add the following line to your `.emacs` or `init.el` file:

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 20)
  (selected-window-accent-custom-color "goldenrod")
  (selected-window-accent-mode-style 'default))
#+end_src

This will accent the modeline only for the selected window with the =goldenrod= color.

** Example 2 - Tiling / custom color / custom fringe thickness

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/selected-window-accent-mode-02.jpg]]

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 6)
  (selected-window-accent-custom-color "#4179b2")
  (selected-window-accent-mode-style 'tiling))
#+end_src

This will accent the full outline of the window with the color #4179b2 more akin to a tiling window manager.

** Example 3 - Tiling / theme highlight color

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/selected-window-accent-mode-03.jpg]]

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 6)
  (selected-window-accent-custom-color nil)
  (selected-window-accent-mode-style 'tiling))
#+end_src

This will accent the full outline of the window with the =highlight= color taken from the current theme.

** Example 4 - Subtle / custom fringe thickness (thick)

#+attr_org: :width 300px
#+attr_html: :width 100%
[[file:img/selected-window-accent-mode-04.jpg]]

#+begin_src elisp
(use-package selected-window-accent-mode
  :config (selected-window-accent-mode 1)
  :custom
  (selected-window-accent-fringe-thickness 20)
  (selected-window-accent-custom-color nil)
  (selected-window-accent-mode-style 'subtle))
#+end_src

This will accent the modeline and just the left fringe and in this case be quite a pronounced thick accent.

* Customization

These are the entries in the emacs help / documentation, at some stage I shall push-block these to the elisp file itsself to ensure consistency but for the moment I could need to source START END refactor my existing routine.

** selected-window-accent-fringe-thickness

The thickness of the fringes in pixels.

This thickness is used when the `selected-window-accent-mode-style' is either tiling or subtle.

** selected-window-accent-custom-color

Custom accent color for the selected window.

When set to a color, this color will override the default highlight face background color as the accent color for the selected window.  Setting this to nil disables the custom color, reverting to the default behavior.

** selected-window-accent-mode

Mode variable for `selected-window-accent-mode'.

When non-nil, the `selected-window-accent-mode` is active, accenting the selected window according to the style defined in `selected-window-accent-mode-style`.

** selected-window-accent-mode-style

Current style for accenting the selected window.

 The style determines how the selected window is visually distinguished from unselected ones.

 - `default': No special styling, uses the default Emacs appearance.

 - `tiling': Accentuates the fringes and mode line of the selected window with a thicker appearance, based on `selected-window-accent-fringe-thickness`.

 - `subtle': Adds a subtle accent to the selected window with minimal visual change.

** selected-window-accent-percentage-darken

The percentage the highlight accent is darkened.

This percentage of darkening used when the `selected-window-accent-custom-color' is set to nil and hence the color is chosen from the current theme.

** selected-window-accent-percentage-desaturate

The percentage the highlight accent is saturated.

This percentage of desaturation used when the `selected-window-accent-custom-color' is set to nil and hence the color is chosen from the current theme.

** selected-window-accent-tab-accent

When non-nil, the `selected-window-accent-tab-accent` is active.  Accenting the selected selected tab in the tab-bar.

** selected-window-accent-smart-borders

When non-nil, the `selected-window-accent-smart-borders` is active.  Doesn't accent when a frame contains only a single window.

* Minor Mode

The =selected-window-accent-mode= is a global minor mode that you can toggle to enable or disable the accenting of the selected window.

When enabled, it distinguishes the selected window with a special accent color.

* Hooks

Two hooks are used to automatically update the window accents when the window configuration or state changes:

- window-configuration-change-hook
- window-state-change-hook

These are added when the =selected-window-accent-mode= is enabled and removed when disabled.

* kanban (ROADMAP)

#+begin: kanban :layout ("..." . 50) :scope nil :range ("TODO" . "DOING") :sort "O" :depth 3 :match "ROADMAP" :compressed t
| TODO                                               | DOING |
|----------------------------------------------------+-------|
| [[file:README.org::*add darken desaturated and tab highlight examples to README][add darken desaturated and tab highlight exampl...]] |       |
| [[file:README.org::*define accent color hue adjustment][define accent color hue adjustment]]                 |       |
| [[file:README.org::*define compensating margin][define compensating margin]]                         |       |
| [[file:README.org::*Incorporate mode-line-active and mode-line-inactive somehow][Incorporate mode-line-active and mode-line-inac...]] |       |
| [[file:README.org::*header-line not shown on window split][header-line not shown on window split]]              |       |
| [[file:README.org::*adjust the not selected-window margin to avoid little window navigation. disruption][adjust the not selected-window margin to avoid ...]] |       |
| [[file:README.org::*excess selected-window disruption in header-line. (not sure I can do much about this)][excess selected-window disruption in header-lin...]] |       |
| [[file:README.org::*define which theme face attribute to use as the main accent color][define which theme face attribute to use as the...]] |       |
#+end:

* kanban (ISSUES)

#+begin: kanban :layout ("..." . 50) :scope nil :range ("WATCH" . "DONE") :sort "O" :depth 3 :match "ISSUES" :compressed t
| WATCH                                              | TODO                            | DOING                                    | DONE                                               |
|----------------------------------------------------+---------------------------------+------------------------------------------+----------------------------------------------------|
| [[file:README.org::*possible overheads of updating visual elements for each window?][possible overheads of updating visual elements ...]] | [[file:README.org::*Limiting magit-log when enabled][Limiting magit-log when enabled]] | [[file:README.org::*#4 Doesn't work well with other packages][#4 Doesn't work well with other packages]] | [[file:README.org::*#3 Package breaks fringes][#3 Package breaks fringes]]                          |
| [[file:README.org::*careful with removing header-line on all windows][careful with removing header-line on all windows]]   |                                 |                                          | [[file:README.org::*#1 Do not apply highlighting when frame only contains 1 window][#1 Do not apply highlighting when frame only co...]] |
|                                                    |                                 |                                          | [[file:README.org::*restore modeline height when switching between modes][restore modeline height when switching between ...]] |
|                                                    |                                 |                                          | [[file:README.org::*define accent color saturation adjustment][define accent color saturation adjustment]]          |
|                                                    |                                 |                                          | [[file:README.org::*define accent color darken adjustment][define accent color darken adjustment]]              |
|                                                    |                                 |                                          | [[file:README.org::*highlight selected tab with same accent color][highlight selected tab with same accent color]]      |
|                                                    |                                 |                                          | [[file:README.org::*add to MELPA][add to MELPA]]                                       |
|                                                    |                                 |                                          | [[file:README.org::*minor change to properly format color-theme-buffer-local][minor change to properly format color-theme-buf...]] |
|                                                    |                                 |                                          | [[file:README.org::*pacified package-lint with visual-fill-column 0.0][pacified package-lint with visual-fill-column 0.0]]  |
|                                                    |                                 |                                          | [[file:README.org::*Added similar package comparisons as suggested][Added similar package comparisons as suggested]]     |
|                                                    |                                 |                                          | [[file:README.org::*rename color-name-to-hex to selected-window-accent--color-name-to-hex][rename color-name-to-hex to selected-window-acc...]] |
|                                                    |                                 |                                          | [[file:README.org::*Fixing issues to be able to submit to MELPA][Fixing issues to be able to submit to MELPA]]        |
|                                                    |                                 |                                          | [[file:README.org::*images to img directory and referenced from README][images to img directory and referenced from README]] |
|                                                    |                                 |                                          | [[file:README.org::*expand emacs help / documentation][expand emacs help / documentation]]                  |
|                                                    |                                 |                                          | [[file:README.org::*add GNU header][add GNU header]]                                     |
|                                                    |                                 |                                          | [[file:README.org::*cope better with 0 thickness][cope better with 0 thickness]]                       |
|                                                    |                                 |                                          | [[file:README.org::*Add ChangeLog.][Add ChangeLog.]]                                     |
|                                                    |                                 |                                          | [[file:README.org::*visual-fill-column-mode not working again!][visual-fill-column-mode not working again!]]         |
|                                                    |                                 |                                          | [[file:README.org::*improve modeline contrast between fg and bg][improve modeline contrast between fg and bg]]        |
#+end:

* ISSUES (github)                                                    :ISSUES:

** DOING #4 Doesn't work well with other packages
olivetti & org-sticky-header broken with selected-window-accent-mode
** DONE #3 Package breaks fringes
** DONE #1 Do not apply highlighting when frame only contains 1 window

* ISSUES (other)                                                     :ISSUES:

** TODO Limiting magit-log when enabled
** WATCH possible overheads of updating visual elements for each window?
** WATCH careful with removing header-line on all windows
for example magit commit window and probably some others may need to add some logic depending on mode.
** DONE restore modeline height when switching between modes
** DONE define accent color saturation adjustment
CLOSED: [2024-02-08 Thu 12:13]
** DONE define accent color darken adjustment
CLOSED: [2024-02-08 Thu 12:13]
** DONE highlight selected tab with same accent color
CLOSED: [2024-02-08 Thu 11:17]
** DONE add to MELPA
CLOSED: [2024-02-04 Sun 11:17]
** DONE minor change to properly format color-theme-buffer-local
CLOSED: [2024-01-29 Mon 16:46]
** DONE pacified package-lint with visual-fill-column 0.0
CLOSED: [2024-01-29 Mon 21:11]
** DONE Added similar package comparisons as suggested
CLOSED: [2024-01-29 Mon 21:11]
** DONE rename color-name-to-hex to selected-window-accent--color-name-to-hex
CLOSED: [2024-01-25 Thu 11:38]
** DONE Fixing issues to be able to submit to MELPA
CLOSED: [2024-01-25 Fri 10:38]
- byte-compile / flycheck
- checkdoc
- package-lint
- other
** DONE images to img directory and referenced from README
CLOSED: [2024-01-25 Fri 09:05]
** DONE expand emacs help / documentation
CLOSED: [2024-01-12 Fri 12:49]
** DONE add GNU header
CLOSED: [2024-01-12 Fri 07:46]
** DONE cope better with 0 thickness
CLOSED: [2024-01-12 Fri 07:33]
** DONE Add ChangeLog.
CLOSED: [2024-01-11 Thu 16:16]
** DONE visual-fill-column-mode not working again!
CLOSED: [2024-01-11 Thu 17:17]
** DONE improve modeline contrast between fg and bg
CLOSED: [2024-01-11 Thu 16:19]

* ROADMAP                                                           :ROADMAP:

** TODO add darken desaturated and tab highlight examples to README
** TODO define accent color hue adjustment
** TODO define compensating margin
** TODO Incorporate mode-line-active and mode-line-inactive somehow
this would make more sense especially in the 'default mode.
** TODO header-line not shown on window split
I have a funny feeling this could be very difficult, if not impossible!
** TODO adjust the not selected-window margin to avoid little window navigation. disruption
hence translating a fringe pixel width to a number of margin characters, not quite sure how I am going to do this yet.
** TODO excess selected-window disruption in header-line. (not sure I can do much about this)
** TODO define which theme face attribute to use as the main accent color
Currently the default is to use the =highlight= face

* Testing

See CHANGELOG.org
